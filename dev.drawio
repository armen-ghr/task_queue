<mxfile host="app.diagrams.net" modified="2024-02-18T19:10:14.771Z" agent="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36" etag="GnlLTKttN8B4n1diMnAP" version="23.1.5" type="device">
  <diagram name="Page-1" id="5qmnXEL1bBDwYwa0DvWV">
    <mxGraphModel dx="993" dy="675" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="8PBFfz3EBvKfGWV53M4T-1" value="&lt;h1&gt;Environments&amp;nbsp;&lt;/h1&gt;1) &quot;Local_env&quot; - Docker compose-based environment that can run all or certain sets of Oryx microservices + databases + Kafka + other services (mock)&lt;br&gt;&quot;Local_env&quot; should be used to run manual and automation tests. It will be run in:&lt;br&gt;&amp;nbsp;- Github pipeline&lt;br&gt;&amp;nbsp;- Developer laptop&lt;br&gt;&amp;nbsp;- QA laptop&lt;br&gt;&lt;br&gt;2) Development / Staging - This is not a stable environment. It&#39;s mainly should be used by developers, sometimes by QA.&lt;br&gt;Any branch can run here.&lt;br&gt;&lt;br&gt;3) QA - This is a very stable environment - preproduction.&lt;br&gt;The main branch code runs here. The main branch contains only fully tested code." style="text;html=1;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="60" y="40" width="470" height="260" as="geometry" />
        </mxCell>
        <mxCell id="8PBFfz3EBvKfGWV53M4T-2" value="&lt;b&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;Journey of a user story&lt;/font&gt;&lt;/b&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="10" y="320" width="320" height="30" as="geometry" />
        </mxCell>
        <mxCell id="8PBFfz3EBvKfGWV53M4T-4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="8PBFfz3EBvKfGWV53M4T-3" target="8PBFfz3EBvKfGWV53M4T-5">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="440" y="475" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="8PBFfz3EBvKfGWV53M4T-3" value="Contract first.&lt;br&gt;Events flow diagram, REST API (POC Done) documentation, Kafka events documentation should be defined before implementation starts." style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="10" y="390" width="230" height="170" as="geometry" />
        </mxCell>
        <mxCell id="8PBFfz3EBvKfGWV53M4T-11" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="8PBFfz3EBvKfGWV53M4T-5" target="8PBFfz3EBvKfGWV53M4T-10">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8PBFfz3EBvKfGWV53M4T-5" value="Developer creates a feature branch in the service repo." style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="450" y="330" width="250" height="170" as="geometry" />
        </mxCell>
        <mxCell id="8PBFfz3EBvKfGWV53M4T-6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="8PBFfz3EBvKfGWV53M4T-3" target="8PBFfz3EBvKfGWV53M4T-7">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="350" y="570" as="targetPoint" />
            <mxPoint x="260" y="580" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="8PBFfz3EBvKfGWV53M4T-12" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" edge="1" parent="1" source="8PBFfz3EBvKfGWV53M4T-7">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="860" y="685" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="8PBFfz3EBvKfGWV53M4T-7" value="QA creates feature branch in automation project repo." style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="450" y="600" width="250" height="170" as="geometry" />
        </mxCell>
        <mxCell id="8PBFfz3EBvKfGWV53M4T-9" value="branch naming conventions should be applied" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;" vertex="1" parent="1">
          <mxGeometry x="345" y="440" width="80" height="100" as="geometry" />
        </mxCell>
        <mxCell id="8PBFfz3EBvKfGWV53M4T-16" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="8PBFfz3EBvKfGWV53M4T-10" target="8PBFfz3EBvKfGWV53M4T-15">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8PBFfz3EBvKfGWV53M4T-10" value="Developer writes&lt;br/&gt;&lt;br&gt;1) code&lt;br&gt;2) unit tests&lt;br/&gt;narrow&lt;br&gt;&amp;nbsp;3) integration tests (in scope of 1 service) &lt;br&gt;4) Mock configurations in &quot;local_env&quot;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="870" y="330" width="250" height="170" as="geometry" />
        </mxCell>
        <mxCell id="8PBFfz3EBvKfGWV53M4T-37" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="8PBFfz3EBvKfGWV53M4T-13" target="8PBFfz3EBvKfGWV53M4T-38">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="3760" y="710" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="8PBFfz3EBvKfGWV53M4T-13" value="QA writes&lt;br/&gt;&lt;br&gt;1) Test cases &lt;br&gt;2) Automation tests (includes flows with multiple services: REST API and Kafka API)" style="rounded=1;whiteSpace=wrap;html=1;arcSize=16;" vertex="1" parent="1">
          <mxGeometry x="860" y="607.5" width="270" height="155" as="geometry" />
        </mxCell>
        <mxCell id="8PBFfz3EBvKfGWV53M4T-19" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="8PBFfz3EBvKfGWV53M4T-15" target="8PBFfz3EBvKfGWV53M4T-18">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8PBFfz3EBvKfGWV53M4T-15" value="" style="dashed=0;outlineConnect=0;html=1;align=center;labelPosition=center;verticalLabelPosition=bottom;verticalAlign=top;shape=mxgraph.webicons.github;gradientColor=#DFDEDE" vertex="1" parent="1">
          <mxGeometry x="1300" y="363.8" width="100" height="102.4" as="geometry" />
        </mxCell>
        <mxCell id="8PBFfz3EBvKfGWV53M4T-17" value="Push to" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1180" y="390" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="8PBFfz3EBvKfGWV53M4T-20" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="8PBFfz3EBvKfGWV53M4T-18">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1910" y="415" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="8PBFfz3EBvKfGWV53M4T-18" value="For every new commit to the feature branch github pipeline builds a new docker image. (version equal to commit id TBD: tag image with branch name)&lt;br&gt;Pipeline runs unit and integration tests on top of the local env" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1560" y="345" width="230" height="140" as="geometry" />
        </mxCell>
        <mxCell id="8PBFfz3EBvKfGWV53M4T-25" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="8PBFfz3EBvKfGWV53M4T-21" target="8PBFfz3EBvKfGWV53M4T-24">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8PBFfz3EBvKfGWV53M4T-21" value="Developer runs &quot;local env&quot; and does tests on it" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1910" y="340" width="210" height="140" as="geometry" />
        </mxCell>
        <mxCell id="8PBFfz3EBvKfGWV53M4T-23" value="local env will be local representation of dev env" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;" vertex="1" parent="1">
          <mxGeometry x="1900" y="260" width="110" height="110" as="geometry" />
        </mxCell>
        <mxCell id="8PBFfz3EBvKfGWV53M4T-28" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="8PBFfz3EBvKfGWV53M4T-24">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2660" y="410" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="8PBFfz3EBvKfGWV53M4T-24" value="Developer pushes his/her changes to dev/staging env and does the required testing" style="whiteSpace=wrap;html=1;rounded=1;" vertex="1" parent="1">
          <mxGeometry x="2250" y="340" width="170" height="140" as="geometry" />
        </mxCell>
        <mxCell id="8PBFfz3EBvKfGWV53M4T-26" value="" style="endArrow=none;dashed=1;html=1;rounded=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" edge="1" parent="1" target="8PBFfz3EBvKfGWV53M4T-17">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="2660" y="570" as="sourcePoint" />
            <mxPoint x="1590" y="620" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1210" y="570" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="8PBFfz3EBvKfGWV53M4T-27" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;rounded=0;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="2520" y="560" as="sourcePoint" />
            <mxPoint x="2520" y="410" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="8PBFfz3EBvKfGWV53M4T-31" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="8PBFfz3EBvKfGWV53M4T-29" target="8PBFfz3EBvKfGWV53M4T-30">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8PBFfz3EBvKfGWV53M4T-29" value="Developer opens PR to be reviewed by other developers and QA." style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="2660" y="381.25" width="280" height="217.5" as="geometry" />
        </mxCell>
        <mxCell id="8PBFfz3EBvKfGWV53M4T-36" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="8PBFfz3EBvKfGWV53M4T-30" target="8PBFfz3EBvKfGWV53M4T-35">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8PBFfz3EBvKfGWV53M4T-30" value="To verify the PR, the Github pipeline runs &lt;br&gt;1) unit tests,&lt;br&gt;&amp;nbsp;2) builds a docker image&lt;br&gt;3) runs local_env with that image&lt;br&gt;4) runs narrow integration and QA&lt;br&gt;automation tests there" style="whiteSpace=wrap;html=1;rounded=1;" vertex="1" parent="1">
          <mxGeometry x="3100" y="390" width="360" height="200" as="geometry" />
        </mxCell>
        <mxCell id="8PBFfz3EBvKfGWV53M4T-33" value="" style="image;aspect=fixed;html=1;points=[];align=center;fontSize=12;image=img/lib/azure2/general/Information.svg;" vertex="1" parent="1">
          <mxGeometry x="3490" y="130" width="64" height="64" as="geometry" />
        </mxCell>
        <mxCell id="8PBFfz3EBvKfGWV53M4T-34" value="All PRs to main should be shippable - breaking changes are not allowed. Using different technics feature flag, interfaces, etc" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;" vertex="1" parent="1">
          <mxGeometry x="3570" y="105" width="260" height="265" as="geometry" />
        </mxCell>
        <mxCell id="8PBFfz3EBvKfGWV53M4T-35" value="When PR is approved:" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="3870" y="381.25" width="400" height="200" as="geometry" />
        </mxCell>
        <mxCell id="8PBFfz3EBvKfGWV53M4T-40" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="8PBFfz3EBvKfGWV53M4T-38" target="8PBFfz3EBvKfGWV53M4T-39">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8PBFfz3EBvKfGWV53M4T-38" value="QA runs feature branch in local_env (use last commit id or feature branch name as docker image version) and performs manual&lt;br&gt;and automated tests. &lt;br&gt;To simulate certain flows QA produces events to Kafka, also consumes messages from Kafka topics. kafka-console-consumer,&lt;br/&gt;kafka-console-producer, kafka rest api can be used. Developer assists QA if needed.&lt;br/&gt;Almost everything should be possible to test on local_env. Flows which are not possible to test in local_env can be tested in dev/staging env.&lt;br/&gt;&lt;b&gt;Golden rule: only fully tested feature branch can be merged to main&lt;/b&gt;. local_env and/or staging are used for testing." style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="3870" y="720" width="400" height="210" as="geometry" />
        </mxCell>
        <mxCell id="8PBFfz3EBvKfGWV53M4T-39" value="When feature branch is fully tested&lt;br&gt;&lt;br&gt;1) QA merges PR to main and notifies other QAs via matermost&lt;br&gt;&lt;br&gt;2) Github pipeline runs existing QA tests and if successful auto deploys main branch to QA env.&lt;br&gt;3) QA moves task to “Deployed In QA” status.&lt;br&gt;4) QA performs e2e manual checks on QA environment.&lt;br&gt;5) If QA finds a new bug with severity higher than minor, QA reverts the PR commit from main and sends task back to developer.&amp;nbsp;QA clarifies priority of the bug with PO.&lt;br&gt;If all is good in QA env QA moves task to Scheduled For Deploy status (need some clarification with current processes)&lt;br&gt;QA Automation parts needs to be understood.!!!!!" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="4550" y="660" width="520" height="290" as="geometry" />
        </mxCell>
        <mxCell id="8PBFfz3EBvKfGWV53M4T-41" value="Release to production.&lt;br&gt;&lt;br&gt;&amp;nbsp;(last day of sprint) or when a PR is ready to be released , SRE checks release board for tasks in Scheduled&lt;br/&gt;For Deploy and Deployed In QA status.&lt;br/&gt;Ideally there should be 0 issues Deployed In QA status, but if there are SRE talks to QA to clarify.&lt;br/&gt;When there are 0 issues Deployed In QA status, SRE starts the releases.&lt;br/&gt;Each ticket issue should have label to indicate related services, e.g. issue_notifier, discoverY_flask, ….&lt;br/&gt;SRE creates release tags (github) for each releasable service.&lt;br/&gt;SRE sends notification to certain channel l 30 min before the release and right after the release.&lt;br/&gt;SRE moves tasks to Released status.&lt;br/&gt;QA performs few e2e manual tests on production and moves tasks to Done (Released) status." style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="4290" y="1070" width="740" height="350" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
